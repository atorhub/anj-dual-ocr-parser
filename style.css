* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  transition: background .5s ease;
  position: relative;
}

/* ===============================
   BASE THEMES (UNCHANGED)
================================ */

body.theme-default {
  --bg: radial-gradient(circle at top,#1e1b4b,#020617);
  --card: rgba(255,255,255,.08);
  --text: #e5e7eb;
  --accent: #8b5cf6;
}

body.theme-galaxy {
  --bg: radial-gradient(circle at top,#2d1b69,#07000f);
  --card: rgba(255,255,255,.1);
  --text: #f5f3ff;
  --accent: #c084fc;
}

body.theme-fairy {
  --bg: linear-gradient(135deg,#2e026d,#a21caf);
  --card: rgba(255,255,255,.12);
  --text: #fdf4ff;
  --accent: #f0abfc;
}

body.theme-pink {
  --bg: linear-gradient(135deg,#3b021f,#831843);
  --card: rgba(255,255,255,.14);
  --text: #ffe4f1;
  --accent: #fb7185;
}

body.theme-dark {
  --bg: #020617;
  --card: rgba(255,255,255,.06);
  --text: #e5e7eb;
  --accent: #38bdf8;
}

/* ===============================
   NEW THEMES (BASE COLORS)
================================ */

body.theme-aqua {
  --bg: radial-gradient(circle at top, #7cecff 0%, #0a2a3a 55%, #03141c 100%);
  --accent: #7cecff;
  --card: rgba(35,110,130,0.22);
}

body.theme-mint {
  --bg: radial-gradient(circle at top, #9affdd 0%, #0b2f26 55%, #041714 100%);
  --accent: #9affdd;
  --card: rgba(40,120,95,0.22);
}

body.theme-midnight {
  --bg: radial-gradient(circle at top, #7a7fff 0%, #0a0d24 55%, #03040d 100%);
  --accent: #7a7fff;
  --card: rgba(45,50,120,0.22);
}

/* ===============================
   LAYOUT (UNCHANGED)
================================ */

.app-shell { display:flex; min-height:100vh; }

.sidebar {
  width:220px;
  padding:20px;
  background:rgba(0,0,0,.45);
  backdrop-filter:blur(18px);
}

.nav-item {
  padding:14px;
  border-radius:14px;
  margin-bottom:10px;
  opacity:.7;
}

.nav-item.active,
.nav-item:hover {
  opacity:1;
  background:var(--card);
  box-shadow:0 0 18px var(--accent);
}

.main { flex:1; padding:24px; }

.topbar {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:24px;
}

/* ===============================
   GRID MODES (UNCHANGED)
================================ */

body.layout-dashboard .grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:24px;
}

body.layout-focus .grid {
  display:grid;
  grid-template-columns:1fr;
  gap:24px;
}

body.layout-vertical .grid {
  display:flex;
  flex-direction:column;
  gap:20px;
}

/* ===============================
   PANELS (UNCHANGED)
================================ */

.panel {
  background:var(--card);
  border-radius:22px;
  padding:22px;
  backdrop-filter:blur(18px);
  box-shadow:0 8px 30px rgba(0,0,0,.35),
             inset 0 0 0 1px rgba(255,255,255,.08);
  animation:fadeUp .4s ease both;
}

pre {
  min-height:130px;
  padding:16px;
  border-radius:14px;
  background:rgba(255,255,255,.05);
  white-space:pre-wrap;
}

pre:empty::before {
  content:"Waiting for outputâ€¦";
  animation:pulse 1.6s infinite;
}

/* ===============================
   BUTTONS (UNCHANGED)
================================ */

.actions button {
  padding:10px 18px;
  border-radius:999px;
  border:none;
  background:var(--accent);
  font-weight:600;
}

/* ===============================
   AMBIENT PARTICLES (ONLY 3 THEMES)
================================ */

body::before {
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:0;
}

body.theme-mint::before,
body.theme-aqua::before,
body.theme-midnight::before {
  opacity:0.35;
  background-image:
    radial-gradient(rgba(255,255,255,0.25) 1px, transparent 1px);
  background-size:5px 5px;
  animation:twinkle 8s ease-in-out infinite alternate;
}

/* ===============================
   ðŸŒ• VISIBLE MOON GLOW (KEY PART)
================================ */

body::after {
  content:"";
  position:fixed;
  top:-20%;
  left:50%;
  transform:translateX(-50%);
  width:90vmax;
  height:90vmax;
  border-radius:50%;
  pointer-events:none;
  opacity:0;
  filter:blur(80px);
}

/* Mint Moon */
body.theme-mint::after {
  opacity:0.55;
  background:radial-gradient(circle,
    rgba(170,255,220,0.9) 0%,
    rgba(170,255,220,0.4) 30%,
    transparent 65%);
}

/* Aqua Light Pool */
body.theme-aqua::after {
  opacity:0.5;
  background:radial-gradient(circle,
    rgba(140,240,255,0.9) 0%,
    rgba(140,240,255,0.4) 30%,
    transparent 65%);
}

/* Midnight Moon */
body.theme-midnight::after {
  opacity:0.45;
  background:radial-gradient(circle,
    rgba(180,170,255,0.9) 0%,
    rgba(180,170,255,0.4) 30%,
    transparent 65%);
}

/* ===============================
   ANIMATIONS
================================ */

@keyframes fadeUp {
  from { opacity:0; transform:translateY(10px); }
  to { opacity:1; transform:none; }
}

@keyframes pulse {
  0%,100% { opacity:.4; }
  50% { opacity:.9; }
}

@keyframes twinkle {
  from { opacity:0.25; }
  to { opacity:0.45; }
}

/* ===============================
   MOBILE
================================ */

@media(max-width:768px){
  .sidebar{display:none;}
}
/* =========================================
   FIX: Moon glow stacking order
========================================= */

body::after,
body::before {
  z-index: 0;
}

.app-shell {
  position: relative;
  z-index: 1;
}
